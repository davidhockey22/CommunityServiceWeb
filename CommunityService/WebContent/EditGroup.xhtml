<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Edit Group</title>
	<h:outputStylesheet library="css" name="WebContent/css/main.css" />
</h:head>
<h:body>
	<ui:composition template="commonTemplate.xhtml">
		<ui:define name="metadata">
			<f:metadata>
				<f:viewParam id = "groupId" name="groupId" value="#{editGroupBean.groupId}"/>
				<f:viewAction type="preRenderView" listener="#{editGroupBean.fetchGroup}" />
			</f:metadata>
		</ui:define>
		<ui:define name="content">
			<div style="clear: left">
				<ui:fragment rendered="#{editGroupBean.group == null}">
					<h:outputFormat value="Oops! This group doesn't exist!" />
				</ui:fragment>
				<ui:fragment rendered="#{editGroupBean.group != null}">
					<p:panelGrid columns="2">
						<p:row>
							<p:column style="width:200px">
								<h:outputText value="Name: " />
							</p:column>
							<ui:fragment rendered="#{editGroupBean.admin}">
								<p:column>
									<p:inplace id="ajaxInplace0" editor="true">
										<p:inputText value="#{editGroupBean.group.groupName}"
											required="true" label="text" onkeyup="showUnsaved()" />
									</p:inplace>
								</p:column>
							</ui:fragment>
							<ui:fragment rendered="#{editGroupBean.admin == false}">
								<p:column>
									<h:outputText value="#{editGroupBean.group.groupName}"></h:outputText>
								</p:column>
							</ui:fragment>
						</p:row>
					</p:panelGrid>

					<h:form id="form">
						<ui:fragment rendered="#{editGroupBean.admin}">
							<p:dataTable id="mods" var="v" value="#{editGroupBean.mods}"
								rowKey="#{v.volunteerName}"
								selection="#{editGroupBean.selected}" selectionMode="multiple">

								<f:facet name="header">Moderators</f:facet>

								<p:column headerText="Name">
									#{v.volunteerName}
								</p:column>

								<f:facet name="footer">
									<p:commandButton type="submit" value="Remove"
										update=":form:mods"
										actionListener="#{editGroupBean.removeMods}"></p:commandButton>
								</f:facet>
							</p:dataTable>
						</ui:fragment>

							<p:dataTable id="mems" var="v" value="#{editGroupBean.members}"
								rowKey="#{v.volunteerName}"
								selection="#{editGroupBean.selectedMembers}" selectionMode="multiple">

								<f:facet name="header">Group Members</f:facet>

								<p:column headerText="Name">
									#{v.volunteerName}
								</p:column>

								<f:facet name="footer">
									<p:commandButton type="submit" value="Remove"
										update=":form:mems"
										actionListener="#{editGroupBean.removeMembers}"></p:commandButton>
								</f:facet>
							</p:dataTable>
							
							<p:commandButton type="submit" value="Save Changes"
								actionListener="#{editGroupBean.save}"></p:commandButton>							
					</h:form>
				</ui:fragment>
			</div>
		</ui:define>
	</ui:composition>

	<script type="text/javascript">
		function test() {
			document.getElementById("removeButton").value = "Test";
			return false;
		}
	</script>
</h:body>
</html>